<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>About Us | Fredrick Onyango</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      font-family: "Times New Roman", Times, serif;
      background: linear-gradient(135deg, #4b2e83, #1e1e2f);
      color: #f0f0f5;
      min-height: 100vh;
      padding: 40px;
    }
    a { color: #ffcc00; text-decoration: none; }
    a:hover { text-decoration: underline; }
    h1, h2 { color: #ffcc00; }
    .condition-card {
      background: rgba(58,58,80,0.95);
      border: 1px solid #555;
      border-radius: 10px;
      padding: 10px;
      margin: 10px 0;
    }
    input, button {
      padding: 8px;
      margin: 5px 0;
      border-radius: 5px;
      border: none;
    }
    button {
      cursor: pointer;
      background: #ffcc00;
      color: #1e1e2f;
      font-weight: bold;
    }
    button:hover { background: #ffd633; }
  </style>
</head>
<body>
  <h1>About Us</h1>
  <p>Welcome! I’m Fredrick Onyango. Here’s the story behind my startup and what drives us.</p>
  <p>Our team collaborates on data analytics, machine learning, and health informatics projects.</p>

  <!-- Disease Lookup -->
  <h2>Disease Lookup</h2>
  <p>Type a disease name to search in FHIR:</p>
  <input type="text" id="disease-input" placeholder="Enter disease name...">
  <button id="search-btn">Search</button>
  <div id="search-results">Results will appear here.</div>

  <p><a href="index.html">← Back to Home</a></p>

  <script>
    const fhirBase = "https://hapi.fhir.org/baseR4";
    const input = document.getElementById("disease-input");
    const btn = document.getElementById("search-btn");
    const results = document.getElementById("search-results");

    btn.addEventListener("click", () => {
      const query = input.value.trim();
      if (!query) return alert("Please enter a disease name.");
      searchCondition(query);
    });

    async function searchCondition(name) {
      results.innerHTML = "Searching...";
      try {
        const res = await fetch(`${fhirBase}/Condition?code:text=${encodeURIComponent(name)}&_count=10`);
        const data = await res.json();
        results.innerHTML = "";

        if (!data.entry || data.entry.length === 0) {
          results.innerHTML = "No results found.";
          return;
        }

        data.entry.forEach(e => {
          const cond = e.resource;
          const snomed = cond.code.coding.find(c => c.system.includes("snomed"))?.code || "-";
          const icd = cond.code.coding.find(c => c.system.includes("icd"))?.code || "-";
          const parents = cond.extension?.filter(ext => ext.url.includes("parent")).map(p => p.valueReference.reference) || [];
          const children = cond.extension?.filter(ext => ext.url.includes("child")).map(c => c.valueReference.reference) || [];
          const category = cond.category?.map(c => c.coding.map(cd => cd.code).join(", ")).join(", ") || "-";
          const clinicalStatus = cond.clinicalStatus?.coding?.map(c => c.code).join(", ") || "-";

          const html = `
            <div class="condition-card">
              <strong>${cond.code.text || "No name"}</strong><br>
              SNOMED: ${snomed} | ICD: ${icd}<br>
              Parents: ${parents.join(", ") || "None"}<br>
              Children: ${children.join(", ") || "None"}<br>
              Category: ${category}<br>
              Clinical Status: ${clinicalStatus}
            </div>
          `;
          results.innerHTML += html;
        });
      } catch(err) {
        results.innerHTML = "Error fetching data from FHIR.";
        console.error(err);
      }
    }
  </script>
</body>
</html>
